<!-- include A-Frame obviously -->
<script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>

<script>
  AFRAME.registerComponent('marker-sound-handler', {
    init: function () {
      const marker = this.el; // The marker entity
      const soundEntity = document.querySelector('[sound]'); // The entity with the sound component

      // Attach event listeners to the marker
      marker.addEventListener('markerFound', function() {
        console.log('Marker Found!');
        // Play the sound when the marker is found
        soundEntity.components.sound.playSound();
      });

      marker.addEventListener('markerLost', function() {
        console.log('Marker Lost!');
        // Pause or stop the sound when the marker is lost
        soundEntity.components.sound.pauseSound(); // Or stopSound() if you want it to restart from the beginning
      });
    }
  });
</script>

<body style='margin : 0px; overflow: hidden;'>
  <a-scene embedded arjs='sourceType: webcam;'>

    <a-assets>
      <audio id="markerSound" src="assets/quack.mp3" preload="auto"></audio>
    </a-assets>

    <a-marker preset='hiro' id="myMarker" marker-sound-handler>
      <a-box position='0 0.5 0' material='opacity: 0.5;'></a-box>
    </a-marker>


    <a-marker preset='custom' type='pattern' url='https://github.com/bugarin03/bugarin03.github.io/blob/main/assets/pattern-ucu.patt'>
      <a-box position='0 0 0' material='opacity: 0.5;'></a-box>
    </a-marker>

    <a-entity sound="src: #markerSound; autoplay: false;"></a-entity> 
    <a-entity camera></a-entity>

  </a-scene>
</body>